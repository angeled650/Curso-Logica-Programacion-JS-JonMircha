<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ejercicio 27</title>
  <style>
    html {
      box-sizing: border-box;
      font-family: sans-serif;
      font-size: 16px;
    }

    h1 {
      text-align: center;
    }

    *,
    *::before,
    *::after {
      box-sizing: inherit;
    }

    .return {
      display: block;
      text-align: center;
    }

    #btn {
      display: block;
      margin: auto
    }
  </style>
</head>

<body>
  <h1>Ejercicio 27</h1>
  <p>
    Programa una clase llamada Pelicula.
    La clase recibirá un objeto al momento de instanciarse con los siguentes datos: id de la película en IMDB, titulo,
    director, año de estreno, país o países de origen, géneros y calificación en IMBD.
  </p>
  <ul>
    <li>Todos los datos del objeto son obligatorios.</li>
    <li>Valida que el id IMDB tenga 9 caracteres, los primeros 2 sean letras y los
      7 restantes números.</li>
    <li>Valida que el título no rebase los 100 caracteres.</li>
    <li>Valida que el director no rebase los 50 caracteres.</li>
    <li>Valida que el año de estreno sea un número entero de 4 dígitos.</li>
    <li>Valida que el país o paises sea introducidos en forma de arreglo.</li>
    <li>Valida que los géneros sean introducidos en forma de arreglo.</li>
    <li>Valida que los géneros introducidos esten dentro de los géneros
      aceptados*.</li>
    <li>Crea un método estático que devuelva los géneros aceptados*.</li>
    <li>Valida que la calificación sea un número entre 0 y 10 pudiendo ser
      decimal de una posición.</li>
    <li>Crea un método que devuelva toda la ficha técnica de la película.</li>
    <li>Apartir de un arreglo con la información de 3 películas genera 3.</li>
    <li>instancias de la clase de forma automatizada e imprime la ficha técnica
      de cada película.</li>
  </ul>
  <p>
    * Géneros Aceptados: Action, Adult, Adventure, Animation, Biography, Comedy, Crime, Documentary ,Drama, Family,
    Fantasy,
    Film Noir, Game-Show, History, Horror, Musical, Music, Mystery, News, Reality-TV, Romance, Sci-Fi, Short, Sport,
    Talk-Show, Thriller, War, Western.</p>
  <button id="btn">Haz click para probar el ejercicio</button>
  <br>
  <hr>
  <a class="return" href="../index.html">Regresar a la Página Principal</a>

  <script>
    /* 27) Programa una clase llamada Pelicula.
  La clase recibirá un objeto al momento de instanciarse con los siguentes datos: id de la película en IMDB, titulo, director, año de estreno, país o países de origen, géneros y calificación en IMBD.
    - Todos los datos del objeto son obligatorios.
    - Valida que el id IMDB tenga 9 caracteres, los primeros 2 sean letras y los
       7 restantes números.
    - Valida que el título no rebase los 100 caracteres.
    - Valida que el director no rebase los 50 caracteres.
    - Valida que el año de estreno sea un número entero de 4 dígitos.
    - Valida que el país o paises sea introducidos en forma de arreglo.
    - Valida que los géneros sean introducidos en forma de arreglo.
    - Valida que los géneros introducidos esten dentro de los géneros
       aceptados*.
    - Crea un método estático que devuelva los géneros aceptados*.
    - Valida que la calificación sea un número entre 0 y 10 pudiendo ser
      decimal de una posición.
    - Crea un método que devuelva toda la ficha técnica de la película.
    - Apartir de un arreglo con la información de 3 películas genera 3
      instancias de la clase de forma automatizada e imprime la ficha técnica
      de cada película.
  
  * Géneros Aceptados: Action, Adult, Adventure, Animation, Biography, Comedy, Crime, Documentary ,Drama, Family, Fantasy, Film Noir, Game-Show, History, Horror, Musical, Music, Mystery, News, Reality-TV, Romance, Sci-Fi, Short, Sport, Talk-Show, Thriller, War, Western. */

    class Pelicula {
      constructor(peli) {
        this.id = peli.id;
        this.titulo = peli.titulo;
        this.director = peli.director;
        this.anio = peli.anio;
        this.pais = peli.pais;
        this.genero = peli.genero;
        this.calificacion = peli.calificacion;
      }

      static get listaGeneros() {
        return ["Action", "Adult", "Adventure", "Animation", "Biography", "Comedy", "Crime", "Documentary", "Drama", "Family", "Fantasy", "Film Noir", "Game - Show", "History", "Horror", "Musical", "Music", "Mystery", "News", "Reality - TV", "Romance", "Sci - Fi", "Short", "Sport", "Talk - Show", "Thriller", "War", "Western"];
      }

      static generosAceptados() {
        return alert(`Generos Aprobados: [${Pelicula.listaGeneros.join(", ")}]`);
      }

      fichaTecnica() {
        console.log(`| FICHA TECNICA DE LA PELICULA |\nID en IMDB: ${this.id}\nTitulo: ${this.titulo}\nDirector(es): ${this.director}\nAño de estreno: ${this.anio}\nPais(es): ${this.pais}\nGenero(s): ${this.genero}\nCalificacion en IMDB: ${this.calificacion}`);
      }
    }

    const validarId = (id = "") => {
      let val = /^[a-zA-Z]{2}[0-9]{7}$/;

      if (!id) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (val.test(id) === false) {
        alert(`${id} no es un ID válido.`);
        return false;
      }

      return true;
    }

    const validarTitulo = (titulo = "") => {
      if (!titulo) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (titulo.length > 100) {
        alert(`El título no puede superar los 100 caracteres.`);
        return false;
      }

      return true;
    }

    const validarDirector = (director = "") => {
      if (!director) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (director.length > 50) {
        alert(`El nombre del director no puede superar los 50 caracteres.`);
        return false;
      }

      return true;
    }

    const validarAnio = (anio = undefined) => {
      let val = /^[0-9]{4}$/;

      if (anio == undefined) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (val.test(anio) === false) {
        alert(`${anio} no es un año válido.`);
        return false;
      }

      return true;
    }

    const validarPais = (pais = undefined) => {
      let val = /^[a-záéíóúüA-ZÁÉÍÓÚÜ]{1,} ?[a-záéíóúüA-ZÁÉÍÓÚÜ]{1,}$/;

      if (pais == undefined) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (val.test(pais) === false) {
        alert(`${pais} no es un país válido.`);
        return false;
      }

      return true;
    }

    const validarGenero = (genero = undefined) => {
      if (genero == undefined) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (!Pelicula.listaGeneros.includes(genero)) {
        alert(`${genero} no es un género válido.`);
        return false;
      }

      return true;
    }

    const validarCalificacion = (calificacion = undefined) => {
      if (calificacion == undefined) {
        alert("No puede dejar el campo vacío.");
        return false;
      }

      if (isNaN(calificacion) === true) {
        alert(`${calificacion} no es una calificación válida.`);
        return false;
      }

      if ((Math.sign(calificacion) === -1)) {
        alert("No puede ingresar un número negativo.");
        return false;
      }

      if (calificacion > 10) {
        alert("No puede ingresar una calificación mayor a 10.");
        return false;
      }

      return true
    }

    const validaciones = (tamanio = undefined) => {
      if (tamanio == undefined) {
        alert("No ha ingresado ningún número.");
        return false;
      }

      if (isNaN(tamanio) == true) {
        alert("No ha ingresado un número válido.");
        return false;
      }

      if ((Math.sign(tamanio) === -1)) {
        alert("No puede ingresar un número negativo.");
        return false;
      }

      return true;
    }
    const $btn = document.getElementById("btn");

    $btn.addEventListener("click", e => {
      let numPeli = prompt(`Ingrese el número de Películas a agregar: `);
      let numePeli = parseInt(numPeli);
      let pelis = [];


      if (validaciones(numePeli) == true) {
        for (let i = 0; i < numePeli; i++) {
          let pais = [], genero = [];
          let sal = 1;
          let opc1 = true, opc2 = true;

          let id = prompt(`Ingrese el ID de IMDB de la pelicula: `);
          if (validarId(id) == false) {
            break;
          }

          let titulo = prompt(`Ingrese el título de la pelicula: `);
          if (validarTitulo(titulo) == false) {
            break;
          }

          let director = prompt(`Ingrese el director de la pelicula: `);
          if (validarDirector(director) == false) {
            break;
          }

          let anio = prompt(`Ingrese el año de la pelicula: `);
          if (validarAnio(anio) == false) {
            break;
          }

          //Agregar Países
          while (opc1 == true) {
            let pais2 = prompt(`Ingrese el país de origen de la pelicula: `);
            if (validarPais(pais2) == false) {
              sal = 0;
              break;
            } else {
              pais.push(pais2);
              opc1 = confirm("¿Desea agregar otro país de origen a la película?");
            }
          }

          if (sal == 0) {
            break;
          }

          //Agregar Géneros
          while (opc2 == true) {
            let gener = prompt(`Ingrese el genero de la pelicula: `);
            if (validarGenero(gener) == false) {
              sal = 0;
              break;
            } else {
              genero.push(gener);
              opc2 = confirm("¿Desea agregar otro género a la película?");
            }
          }

          if (sal == 0) {
            break;
          }

          let cali = prompt(`Ingrese la calificación de la pelicula: `);
          let calificacion = parseFloat(cali);
          if (validarCalificacion(calificacion) == false) {
            break;
          } else {
            calificacion = Math.round(calificacion * 10) / 10;
          }

          let pel = {
            id,
            titulo,
            director,
            anio,
            pais,
            genero,
            calificacion
          }
          pelis[i] = new Pelicula(pel);
        }

        pelis.forEach(elem => elem.fichaTecnica());
      }
    })
  </script>
</body>

</html>